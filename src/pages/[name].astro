---
import Layout from "@layouts/Layout/Layout.astro";
import { get_pokemons_fetch } from "@views/Index/get_pokemons_fetch";
import type { GetStaticPaths } from "astro";

export const getStaticPaths = (async () => {
  const { results } = await get_pokemons_fetch({ limit: 40 });

  const paths = results.map((result) => {
    const { name } = result;
    const img = result.sprites.other?.["official-artwork"].front_default;
    const audio = result.cries.latest;
    return { params: { name }, props: { audio, img } };
  });

  return paths;
}) satisfies GetStaticPaths;

const { name } = Astro.params;
const { audio, img } = Astro.props;
---

<Layout title={name}>
  <main>
    <h1>{name}</h1>
    <picture>
      <img transition:name={`pokemon_${name}`} src={img} alt={name} />
    </picture>
    <audio controls>
      <source src={audio} type="audio/ogg" />
      Tu navegador no soporta el elemento de audio.
    </audio>
  </main>
</Layout>
